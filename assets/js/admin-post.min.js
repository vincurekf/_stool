!function(i){console.log("_stool::admin-post"),flatpickr.l10ns.default.firstDayOfWeek=1;var e={uploader:{},fields:{},init:function(){var l=this;l.uploader={},l.fields={},i("._stool-media-upload").each(function(){var t=i(this).data("key"),e=i(this);l.fields[t]={},l.fields[t].type=e.data("type"),l.fields[t].input=e.children("._stool-media-input"),l.fields[t].url=l.fields[t].input.val(),l.fields[t].preview=e.children("._stool-media-preview-wrap").children("._stool-media-preview"),l.fields[t].btn_erase=i("#"+t+"_erase_button"),l.fields[t].btn_upload=i("#"+t+"_upload_button"),_.isEmpty(l.fields[t].url)?(l.fields[t].btn_upload.show(),l.fields[t].btn_erase.hide(),l.fields[t].preview.hide()):l.fields[t].btn_upload.hide(),l.fields[t].btn_erase.click(function(e){l.fields[t].btn_upload.show(),l.fields[t].btn_erase.hide(),l.fields[t].preview.hide(),l.fields[t].input.val("")}),l.fields[t].btn_upload.click(function(e){e.preventDefault(),l.open_upload(t)}),l.fields[t].preview.click(function(e){e.preventDefault(),l.open_upload(t)})})},open_upload:function(t){var l=this;l.uploader[t]||(l.uploader[t]=wp.media.frames.file_frame=wp.media({title:"Choose a "+l.fields[t].type,button:{text:"Select"},multiple:!1}),l.uploader[t].on("select",function(){var e=l.uploader[t].state().get("selection").first().toJSON();l.fields[t].input.val(e.url),l.fields[t].preview.attr("src",e.url),l.fields[t].preview.show(),l.fields[t].btn_upload.hide(),l.fields[t].btn_erase.show()})),l.uploader[t].open()}};0<i("._stool-media-upload").length&&e.init(),0<i("._stool-component-wrap").length&&i("._stool-component-wrap").each(function(){var e=i(this),t=e.parent().parent(),l=e.data("icon"),o=t.children(".hndle");o.attr("id",t.attr("id")+"_hndle"),o.addClass("_stool-component-hndle"),t.addClass("_stool-component-postbox"),document.getElementById(t.attr("id")+"_hndle").insertAdjacentHTML("afterbegin",'<img class="_stool-component-icon" src="'+l+'"></img>')}),0<i("._stool_select").length&&i("._stool_select").selectize({create:!1}),0<i('._stool-component > input[type="datetime-local"]').length&&i('._stool-component > input[type="datetime-local"]').each(function(){$el=i(this),console.log($el),$el.flatpickr({dateFormat:"U",enableTime:!0,time_24hr:!0,altInput:!0,altFormat:"j. n. Y H:i"})}),0<i('._stool-component > input[type="date"]').length&&i('._stool-component > input[type="date"]').each(function(){$el=i(this),console.log($el),$el.flatpickr({dateFormat:"U",altInput:!0,altFormat:"j. n. Y"})}),0<i(".color-field").length&&i(".color-field").each(function(){i(this).wpColorPicker()}),0<i("[data-stool-checkbox]").length&&i("[data-stool-checkbox]").on("click",function(e){e.preventDefault();var t=i(this),l=t.data("post-id"),o=t.data("meta-name");i.ajax({type:"POST",url:_stool_ajax.ajax_url,data:{action:"_stool_updateCheckbox",post_id:l,meta_id:o},success:function(e){"on"===e.data.val?t.addClass("active"):t.removeClass("active")}})}),0<i(".stool-dynamic-field").length&&i(".stool-dynamic-field").each(function(){var e=i(this);i("input[id="+e.data("driver")+"]").attr("checked")?e.slideDown():e.slideUp(),i("input[id="+e.data("driver")+"]").on("change",function(){i(this).attr("checked")?e.slideDown():e.slideUp()})})}(jQuery);