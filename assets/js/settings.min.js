!function(e){var i;try{i=window.tinyMCE}catch(s){i=void 0}angular.module("_stool",["as.sortable"]).run(["$rootScope","$http",function(a,s){console.log("_stool::settings"),a.form={loading:!1,success:!1,error:!1,data:{},responsetimeout:null,init:function(){this.form=e("#_stool-settings-form"),this.watch()},different:function(){var s=this;return!_.isUndefined(s.initial)&&!_.isEqual(s.initial,angular.copy(s.data))},reset:function(){this.data=angular.copy(this.initial),a.customizer.sections=angular.copy(a.customizer.initial),a.posttypes.sections=angular.copy(a.posttypes.initial)},submit:function(s){s.preventDefault(),s.stopPropagation();var o=this;_.isUndefined(i)||i.triggerSave(),o.loading=!0,o.success=!1,o.error=!1,o.responsetimeout&&clearTimeout(o.responsetimeout);e("#_stool-settings-form");e.ajax({url:_stool_ajax.options_url,type:o.form.attr("method"),data:o.form.serialize()}).done(function(s){angular.copy(o.initial);o.loading=!1,o.success=!0,o.initial=angular.copy(o.data),a.customizer.initial=angular.copy(a.customizer.sections),a.posttypes.initial=angular.copy(a.posttypes.sections),a.$apply(),o.responsetimeout=setTimeout(function(){o.success=!1,a.$apply()},5e3)}).fail(function(s){console.log("error",s),o.loading=!1,o.error=!0,a.$apply(),o.responsetimeout=setTimeout(function(){o.error=!1,a.$apply()},5e3)})},watch:function(){var s=this;window.onload=function(){s.initial=angular.copy(s.data)},window.onbeforeunload=function(){if(s.different())return"Are you sure you want to leave?"},a.$watch("form.data",function(){},!0)}},a.form.init(),a.image={padding:function(){var s=a.form.data._stool_thumbnails_aspect;return"custom"==a.form.data._stool_thumbnails_aspect&&(s=a.form.data._stool_thumbnails_custom),(s=s.split(":"))[1]/s[0]*100+"%;"}},a.tabs={activeTab:"panel-global",init:function(){this.check()},changetab:function(s){this.activeTab=s,this.setHash(s),e("._stool-color").wpColorPicker({change:function(s){var o=e(s.target).val(),i=e(s.target).attr("ng-model");i=(i=i.split("."))[i.length-1],a.form.data[i]=o,a.$apply()}})},check:function(){location.hash&&(this.changetab(location.hash.substr(1)),a.$apply())},setHash:function(s){_.isEmpty(s)||history.pushState&&history.pushState(null,null,"#"+s)}},a.tabs.init(),a.mmenu={active:!1,init:function(){},toggle:function(){this.active=!this.active},class:function(){var s=a.form.data;return s._stool_menu_transition?"_stool-easing "+s._stool_menu_transition_type:""},style:function(){var s=a.form.data;return s._stool_menu_transition?"transition-property: all;transition-duration: "+s._stool_menu_transition_time+"s;width: "+s._stool_menu_width+"%;":""}},a.customizer={collapse:{},muster_section:{key:"",title:"",priority:1e3,fields:[]},muster_field:{key:"",default:"",label:"",type:"text",choices:[]},typeSelect:["image","checkbox","text","radio","select","textarea","email","url","number","date","color"],ucfirst:function(s){return s.charAt(0).toUpperCase()+s.slice(1)},sections:[],init:function(){var s=e("#_stool_customizer").val();this.sections=JSON.parse(s),this.initial=JSON.parse(s),a.$watch("customizer.sections",function(s,o){var i=JSON.stringify(angular.copy(s));e("#_stool_customizer").val(i),a.form.data._stool_customizer=i},!0)},newSectionTitle:"",addNewSection:function(){if(_.find(this.sections,{key:this.newSectionTitle}))return alert("Does exist");var s=angular.copy(this.newSectionTitle),o=a.helper.slug(s);this.newSectionTitle="";var i=angular.copy(this.muster_section);i.key=o,i.title=s,this.sections.push(i)},newFieldLabel:{},addNewField:function(s){if(_.find(s.fields,{key:this.newFieldLabel[s.key]}))return alert("Does exist");var o=angular.copy(this.newFieldLabel[s.key]),i=s.key+"_"+a.helper.slug(o);this.newFieldLabel[s.key]="";var e=angular.copy(this.muster_field);e.key=i,e.label=o,console.log("newField",e),s.fields.push(e),console.log("section",s)},removeSection:function(o){angular.copy(o.sections);var s=_.reject(this.sections,function(s){return s.key===o.key});this.sections=s,console.log("this.sections",this.sections)},removeField:function(s,o){var i=angular.copy(s.fields);console.log("fields",i);var e=_.reject(i,function(s){return s.key===o.key});s.fields=e,console.log("section.fields",s.fields)},addOption:function(s){console.log(s),_.isUndefined(s.choices)&&(s.choices=[]),s.choices.push("")},removeOption:function(s,o){console.log(s,o),s.choices.splice(o,1),console.log(s.choices)},slug:function(s){s=(s=s.replace(/^\s+|\s+$/g,"")).toLowerCase();for(var o="ÁÄÂÀÃÅČÇĆĎÉĚËÈÊẼĔȆÍÌÎÏŇÑÓÖÒÔÕØŘŔŠŤÚŮÜÙÛÝŸŽáäâàãåčçćďéěëèêẽĕȇíìîïňñóöòôõøðřŕšťúůüùûýÿžþÞĐđßÆa·/_,:;",i=0,e=o.length;i<e;i++)s=s.replace(new RegExp(o.charAt(i),"g"),"aaaaaacccdeeeeeeeeiiiinnoooooorrstuuuuuyyzaaaaaacccdeeeeeeeeiiiinnooooooorrstuuuuuyyzbbddbaa------".charAt(i));return s=s.replace(/[^a-z0-9 -]/g,"").replace(/\s+/g,"_").replace(/-+/g,"_")},dragControlListeners:{accept:function(s,o){return!0},itemMoved:function(s){},orderChanged:function(s){},containerPositioning:"relative",containment:"#wpwrap",allowDuplicates:!1}},a.customizer.init(),a.posttypes={collapse:{},muster_section:{slug:"",main:"",single:"",add:"",of:"",icon:"",metaboxes:[]},muster_field:{key:"",default:"",label:"",type:"text",media_type:"image",options:[]},typeSelect:["checkbox","date","datetime","media","text","textarea","tinymce","color","select"],mediaSelect:["image","video"],iconSelect:["dashicons-menu","dashicons-admin-site","dashicons-dashboard","dashicons-admin-post","dashicons-admin-media","dashicons-admin-links","dashicons-admin-page","dashicons-admin-comments","dashicons-admin-appearance","dashicons-admin-plugins","dashicons-admin-users","dashicons-admin-tools","dashicons-admin-settings","dashicons-admin-network","dashicons-admin-home","dashicons-admin-generic","dashicons-admin-collapse","dashicons-welcome-write-blog","dashicons-welcome-add-page","dashicons-welcome-view-site","dashicons-welcome-widgets-menus","dashicons-welcome-comments","dashicons-welcome-learn-more","dashicons-format-aside","dashicons-format-image","dashicons-format-gallery","dashicons-format-video","dashicons-format-status","dashicons-format-quote","dashicons-format-chat","dashicons-format-audio","dashicons-camera","dashicons-images-alt","dashicons-images-alt2","dashicons-video-alt","dashicons-video-alt2","dashicons-video-alt3","dashicons-image-crop","dashicons-image-rotate-left","dashicons-image-rotate-right","dashicons-image-flip-vertical","dashicons-image-flip-horizontal","dashicons-undo","dashicons-redo","dashicons-editor-bold","dashicons-editor-italic","dashicons-editor-ul","dashicons-editor-ol","dashicons-editor-quote","dashicons-editor-alignleft","dashicons-editor-aligncenter","dashicons-editor-alignright","dashicons-editor-insertmore","dashicons-editor-spellcheck","dashicons-editor-distractionfree","dashicons-editor-kitchensink","dashicons-editor-underline","dashicons-editor-justify","dashicons-editor-textcolor","dashicons-editor-paste-word","dashicons-editor-paste-text","dashicons-editor-removeformatting","dashicons-editor-video","dashicons-editor-customchar","dashicons-editor-outdent","dashicons-editor-indent","dashicons-editor-help","dashicons-editor-strikethrough","dashicons-editor-unlink","dashicons-editor-rtl","dashicons-align-left","dashicons-align-right","dashicons-align-center","dashicons-align-none","dashicons-lock","dashicons-calendar","dashicons-visibility","dashicons-post-status","dashicons-edit","dashicons-trash","dashicons-arrow-up","dashicons-arrow-down","dashicons-arrow-right","dashicons-arrow-left","dashicons-arrow-up-alt","dashicons-arrow-down-alt","dashicons-arrow-right-alt","dashicons-arrow-left-alt","dashicons-arrow-up-alt2","dashicons-arrow-down-alt2","dashicons-arrow-right-alt2","dashicons-arrow-left-alt2","dashicons-sort","dashicons-leftright","dashicons-list-view","dashicons-exerpt-view","dashicons-share","dashicons-share-alt","dashicons-share-alt2","dashicons-twitter","dashicons-rss","dashicons-facebook","dashicons-facebook-alt","dashicons-googleplus","dashicons-networking","dashicons-hammer","dashicons-art","dashicons-migrate","dashicons-performance","dashicons-wordpress","dashicons-wordpress-alt","dashicons-pressthis","dashicons-update","dashicons-screenoptions","dashicons-info","dashicons-cart","dashicons-feedback","dashicons-cloud","dashicons-translation","dashicons-tag","dashicons-category","dashicons-yes","dashicons-no","dashicons-no-alt","dashicons-plus","dashicons-minus","dashicons-dismiss","dashicons-marker","dashicons-star-filled","dashicons-star-half","dashicons-star-empty","dashicons-flag","dashicons-location","dashicons-location-alt","dashicons-vault","dashicons-shield","dashicons-shield-alt","dashicons-search","dashicons-slides","dashicons-analytics","dashicons-chart-pie","dashicons-chart-bar","dashicons-chart-line","dashicons-chart-area","dashicons-groups","dashicons-businessman","dashicons-id","dashicons-id-alt","dashicons-products","dashicons-awards","dashicons-forms","dashicons-portfolio","dashicons-book","dashicons-book-alt","dashicons-download","dashicons-upload","dashicons-backup","dashicons-lightbulb","dashicons-smiley"],sections:[],init:function(){var s=e("#_stool_posttypes").val();this.sections=JSON.parse(s),this.initial=JSON.parse(s),a.$watch("posttypes.sections",function(s,o){var i=JSON.stringify(angular.copy(s));e("#_stool_posttypes").val(i),a.form.data._stool_posttypes=i},!0)},newSectionTitle:"",addNewSection:function(){if(_.find(this.sections,{slug:this.newSectionTitle}))return alert("Does exist");var s=angular.copy(this.newSectionTitle),o=a.helper.slug(s);this.newSectionTitle="";var i=angular.copy(this.muster_section);i.slug=o,i.main=s,i.single=s,i.add=s,i.of=s,this.sections.push(i)},newFieldLabel:{},addNewField:function(s){if(_.find(s.metaboxes,{key:this.newFieldLabel[s.slug]}))return alert("Does exist");var o=angular.copy(this.newFieldLabel[s.slug]),i=s.slug+"_"+a.helper.slug(o);this.newFieldLabel[s.slug]="";var e=angular.copy(this.muster_field);e.key=i,e.label=o,console.log("newField",e),s.metaboxes.push(e),console.log("section",s)},removeSection:function(o){angular.copy(o.sections);var s=_.reject(this.sections,function(s){return s.key===o.key});this.sections=s,console.log("this.sections",this.sections)},removeField:function(s,o){var i=angular.copy(s.metaboxes);console.log("metaboxes",i);var e=_.reject(i,function(s){return s.key===o.key});s.metaboxes=e,console.log("section.metaboxes",s.metaboxes)},addOption:function(s){console.log(s),_.isUndefined(s.options)&&(s.options=[]),s.options.push("")},removeOption:function(s,o){console.log(s,o),s.options.splice(o,1),console.log(s.options)},slug:function(s){s=(s=s.replace(/^\s+|\s+$/g,"")).toLowerCase();for(var o="ÁÄÂÀÃÅČÇĆĎÉĚËÈÊẼĔȆÍÌÎÏŇÑÓÖÒÔÕØŘŔŠŤÚŮÜÙÛÝŸŽáäâàãåčçćďéěëèêẽĕȇíìîïňñóöòôõøðřŕšťúůüùûýÿžþÞĐđßÆa·/_,:;",i=0,e=o.length;i<e;i++)s=s.replace(new RegExp(o.charAt(i),"g"),"aaaaaacccdeeeeeeeeiiiinnoooooorrstuuuuuyyzaaaaaacccdeeeeeeeeiiiinnooooooorrstuuuuuyyzbbddbaa------".charAt(i));return s=s.replace(/[^a-z0-9 -]/g,"").replace(/\s+/g,"_").replace(/-+/g,"_")},dragControlListeners:{accept:function(s,o){return!0},itemMoved:function(s){},orderChanged:function(s){},containerPositioning:"relative",containment:"#wpwrap",allowDuplicates:!1}},a.posttypes.init(),a.helper={ucfirst:function(s){return s.charAt(0).toUpperCase()+s.slice(1)},slug:function(s){s=(s=s.replace(/^\s+|\s+$/g,"")).toLowerCase();for(var o="ÁÄÂÀÃÅČÇĆĎÉĚËÈÊẼĔȆÍÌÎÏŇÑÓÖÒÔÕØŘŔŠŤÚŮÜÙÛÝŸŽáäâàãåčçćďéěëèêẽĕȇíìîïňñóöòôõøðřŕšťúůüùûýÿžþÞĐđßÆa·/_,:;",i=0,e=o.length;i<e;i++)s=s.replace(new RegExp(o.charAt(i),"g"),"aaaaaacccdeeeeeeeeiiiinnoooooorrstuuuuuyyzaaaaaacccdeeeeeeeeiiiinnooooooorrstuuuuuyyzbbddbaa------".charAt(i));return s=s.replace(/[^a-z0-9 -]/g,"").replace(/\s+/g,"_").replace(/-+/g,"_")}}}])}(jQuery);